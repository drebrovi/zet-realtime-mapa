<!DOCTYPE html>
<html lang="hr">
  <head>
    <meta charset="UTF-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1, maximum-scale=1, viewport-fit=cover"
    />
    <title>ZET real-time karta</title>

    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
      crossorigin=""
    />

    <style>
      html,
      body {
        margin: 0;
        padding: 0;
        height: 100%;
        font-family: system-ui, -apple-system, "Segoe UI", sans-serif;
      }

      #map {
        width: 100%;
        height: 100vh;
      }

      .filter-panel {
        position: absolute;
        top: 10px;
        right: 10px;
        z-index: 1000;
        background: rgba(255, 255, 255, 0.95);
        padding: 8px 10px;
        border-radius: 10px;
        font-size: 14px;
        box-shadow: 0 2px 6px rgba(0, 0, 0, 0.25);
        max-width: 260px;
      }

		.menu-toggle-btn {
		  width: 100%;
		  padding: 4px 6px;
		  font-size: 13px;
		  border-radius: 6px;
		  border: 1px solid #ccc;
		  cursor: pointer;
		  background: #f5f5f5;
		}

		.menu-toggle-btn:hover {
		  background: #e9e9e9;
		}

		.menu-content {
		  margin-top: 6px;
		}

		.menu-content.collapsed {
		  display: none;
		}


      .filter-panel label {
        display: inline-flex;
        align-items: center;
        margin-right: 8px;
        margin-bottom: 4px;
        cursor: pointer;
      }

      .filter-panel button {
        margin-top: 4px;
        width: 100%;
        padding: 4px 6px;
        font-size: 13px;
        border-radius: 6px;
        border: 1px solid #ccc;
        cursor: pointer;
        background: #f5f5f5;
      }

      .filter-panel button:hover {
        background: #e9e9e9;
      }

      .lines-panel {
        display: none;
        margin-top: 6px;
        max-height: 180px;
        overflow-y: auto;
        border-top: 1px solid #ddd;
        padding-top: 4px;
        font-size: 12px;
      }

      .lines-panel.open {
        display: block;
      }

      .status-badge {
        margin-top: 6px;
        padding: 3px 6px;
        border-radius: 999px;
        border: 1px solid #ddd;
        font-size: 11px;
        text-align: center;
        white-space: nowrap;
      }

      .status-ok {
        background: #e9f9ef;
        color: #137333;
        border-color: #c3e6cd;
      }

      .status-stale {
        background: #fff8e5;
        color: #8a6d3b;
        border-color: #ffe0a3;
      }

      .status-offline {
        background: #fdecea;
        color: #b3261e;
        border-color: #f5c2c0;
      }

      .status-unknown {
        background: #f5f5f5;
        color: #555;
        border-color: #ddd;
      }

      .vehicle-icon {
        width: 44px;
        height: 44px;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .layout-row {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 4px;
      }

      .layout-column {
        display: flex;
        flex-direction: column;
        align-items: center;
        justify-content: center;
        gap: 2px;
      }

      .vehicle-circle {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 2px solid #ffffff;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        box-shadow: 0 0 4px rgba(0, 0, 0, 0.4);
        color: #ffffff;
        font-size: 13px;
        font-weight: 800;
      }

      .triangle-left,
      .triangle-right,
      .triangle-up,
      .triangle-down {
        width: 0;
        height: 0;
      }

      .triangle-left {
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
        border-right: 10px solid #000;
      }

      .triangle-right {
        border-top: 6px solid transparent;
        border-bottom: 6px solid transparent;
        border-left: 10px solid #000;
      }

      .triangle-up {
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-bottom: 10px solid #000;
      }

      .triangle-down {
        border-left: 6px solid transparent;
        border-right: 6px solid transparent;
        border-top: 10px solid #000;
      }

      .bus-color .vehicle-circle {
        background: #007bff;
      }
      .tram-color .vehicle-circle {
        background: #28a745;
      }

      .bus-color .triangle-left {
        border-right-color: #007bff;
      }
      .bus-color .triangle-right {
        border-left-color: #007bff;
      }
      .bus-color .triangle-up {
        border-bottom-color: #007bff;
      }
      .bus-color .triangle-down {
        border-top-color: #007bff;
      }

      .tram-color .triangle-left {
        border-right-color: #28a745;
      }
      .tram-color .triangle-right {
        border-left-color: #28a745;
      }
      .tram-color .triangle-up {
        border-bottom-color: #28a745;
      }
      .tram-color .triangle-down {
        border-top-color: #28a745;
      }

      .loader-overlay {
        position: fixed;
        inset: 0;
        background: rgba(255, 255, 255, 0.65);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 2000;
      }

      .loader-overlay.hidden {
        display: none;
      }

      .loader-box {
        background: #ffffff;
        padding: 12px 16px;
        border-radius: 12px;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.25);
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 8px;
        font-size: 13px;
      }

      .loader-spinner {
        width: 28px;
        height: 28px;
        border-radius: 50%;
        border: 3px solid #ccc;
        border-top-color: #007bff;
        animation: spin 0.8s linear infinite;
      }

      .loader-text {
        color: #333;
      }

      @keyframes spin {
        to {
          transform: rotate(360deg);
        }
      }

      @media (max-width: 768px) {
        .filter-panel {
          top: 8px;
          right: 8px;
          left: auto;
          transform: none;
          width: auto;
          max-width: 80vw;
          font-size: 12px;
          padding: 6px 8px;
          max-height: 50vh;
          overflow-y: auto;
        }

        .filter-panel button {
          font-size: 12px;
          padding: 4px 6px;
        }

        .lines-panel {
          max-height: 40vh;
        }

        .status-badge {
          font-size: 10px;
        }
      }
    </style>
  </head>
  <body>
	<div class="filter-panel">
	  <button id="menu-toggle" class="menu-toggle-btn">☰ Izbornik</button>

	  <div id="menu-content" class="menu-content collapsed">
		<label><input type="checkbox" id="filter-tram" checked /> Tramvaji</label>
		<label><input type="checkbox" id="filter-bus" checked /> Autobusi</label>

		<button id="btn-toggle-lines">Pokaži linije</button>
		<div id="lines-panel" class="lines-panel"></div>

		<button id="btn-nearest-stop">Najbliža stanica</button>

		<div id="status-badge" class="status-badge status-unknown">
		  ⚪ ZET feed: nepoznato
		</div>
	  </div>
	</div>


    <div id="loader-overlay" class="loader-overlay hidden">
      <div class="loader-box">
        <div class="loader-spinner"></div>
        <div class="loader-text">Učitavam...</div>
      </div>
    </div>

    <div id="map"></div>

    <script
      src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
      crossorigin=""
    ></script>
    <script src="/socket.io/socket.io.js"></script>
    <script src="app.js"></script>
  </body>
</html>
